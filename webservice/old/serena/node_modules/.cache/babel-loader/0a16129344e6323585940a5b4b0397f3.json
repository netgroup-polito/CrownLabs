{"ast":null,"code":"/*!\n * deps/ciphermodes/gcm/helpers.js - AES-GCM Helper Functions\n *\n * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.\n */\n\"use strict\";\n\nvar Long = require(\"long\"),\n    fill = require(\"lodash\").fill,\n    pack = require(\"../pack.js\");\n\nvar E1 = 0xe1000000,\n    E1B = 0xe1,\n    E1L = new Long(E1 >> 8);\n\nfunction generateLookup() {\n  var lookup = [];\n\n  for (var c = 0; c < 256; ++c) {\n    var v = 0;\n\n    for (var i = 7; i >= 0; --i) {\n      if ((c & 1 << i) !== 0) {\n        v ^= E1 >>> 7 - i;\n      }\n    }\n\n    lookup.push(v);\n  }\n\n  return lookup;\n}\n\nvar helpers = module.exports = {\n  // ### Constants\n  E1: E1,\n  E1B: E1B,\n  E1L: E1L,\n  LOOKUP: generateLookup(),\n  // ### Array Helpers\n  arrayCopy: function (src, srcPos, dest, destPos, length) {\n    // Start by checking for negatives since arrays in JS auto-expand\n    if (srcPos < 0 || destPos < 0 || length < 0) {\n      throw new TypeError(\"Invalid input.\");\n    }\n\n    if (dest instanceof Uint8Array) {\n      // Check for overflow if dest is a typed-array\n      if (destPos >= dest.length || destPos + length > dest.length) {\n        throw new TypeError(\"Invalid input.\");\n      }\n\n      if (srcPos !== 0 || length < src.length) {\n        if (src instanceof Uint8Array) {\n          src = src.subarray(srcPos, srcPos + length);\n        } else {\n          src = src.slice(srcPos, srcPos + length);\n        }\n      }\n\n      dest.set(src, destPos);\n    } else {\n      for (var i = 0; i < length; ++i) {\n        dest[destPos + i] = src[srcPos + i];\n      }\n    }\n  },\n  arrayEqual: function (a1, a2) {\n    a1 = a1 || [];\n    a2 = a2 || [];\n    var len = Math.min(a1.length, a2.length),\n        result = a1.length === a2.length;\n\n    for (var idx = 0; idx < len; idx++) {\n      result = result && \"undefined\" !== typeof a1[idx] && \"undefined\" !== typeof a2[idx] && a1[idx] === a2[idx];\n    }\n\n    return result;\n  },\n  // ### Conversions\n  asBytes: function (x, z) {\n    switch (arguments.length) {\n      case 1:\n        z = Buffer.alloc(16);\n        pack.intToBigEndian(x, z, 0);\n        return z;\n\n      case 2:\n        pack.intToBigEndian(x, z, 0);\n        break;\n\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  asInts: function (x, z) {\n    switch (arguments.length) {\n      case 1:\n        z = [];\n        fill(z, 0, 0, 4);\n        pack.bigEndianToInt(x, 0, z);\n        return z;\n\n      case 2:\n        pack.bigEndianToInt(x, 0, z);\n        break;\n\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  oneAsInts: function () {\n    var tmp = [];\n\n    for (var c = 0; c < 4; ++c) {\n      tmp.push(1 << 31);\n    }\n\n    return tmp;\n  },\n  // ## Bit-wise\n  shiftRight: function (x, z) {\n    var b, c;\n\n    switch (arguments.length) {\n      case 1:\n        b = x[0];\n        x[0] = b >>> 1;\n        c = b << 31;\n        b = x[1];\n        x[1] = b >>> 1 | c;\n        c = b << 31;\n        b = x[2];\n        x[2] = b >>> 1 | c;\n        c = b << 31;\n        b = x[3];\n        x[3] = b >>> 1 | c;\n        return b << 31 & 0xffffffff;\n\n      case 2:\n        b = x[0];\n        z[0] = b >>> 1;\n        c = b << 31;\n        b = x[1];\n        z[1] = b >>> 1 | c;\n        c = b << 31;\n        b = x[2];\n        z[2] = b >>> 1 | c;\n        c = b << 31;\n        b = x[3];\n        z[3] = b >>> 1 | c;\n        return b << 31 & 0xffffffff;\n\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  shiftRightN: function (x, n, z) {\n    var nInv, b, c;\n\n    switch (arguments.length) {\n      case 2:\n        b = x[0];\n        nInv = 32 - n;\n        x[0] = b >>> n;\n        c = b << nInv;\n        b = x[1];\n        x[1] = b >>> n | c;\n        c = b << nInv;\n        b = x[2];\n        x[2] = b >>> n | c;\n        c = b << nInv;\n        b = x[3];\n        x[3] = b >>> n | c;\n        return b << nInv;\n\n      case 3:\n        b = x[0];\n        nInv = 32 - n;\n        z[0] = b >>> n;\n        c = b << nInv;\n        b = x[1];\n        z[1] = b >>> n | c;\n        c = b << nInv;\n        b = x[2];\n        z[2] = b >>> n | c;\n        c = b << nInv;\n        b = x[3];\n        z[3] = b >>> n | c;\n        return b << nInv;\n\n      default:\n        throw new TypeError(\"Expected 2 or 3 arguments.\");\n    }\n  },\n  xor: function (x, y, z) {\n    switch (arguments.length) {\n      case 2:\n        x[0] ^= y[0];\n        x[1] ^= y[1];\n        x[2] ^= y[2];\n        x[3] ^= y[3];\n        break;\n\n      case 3:\n        z[0] = x[0] ^ y[0];\n        z[1] = x[1] ^ y[1];\n        z[2] = x[2] ^ y[2];\n        z[3] = x[3] ^ y[3];\n        break;\n\n      default:\n        throw new TypeError(\"Expected 2 or 3 arguments.\");\n    }\n  },\n  multiply: function (x, y) {\n    var r0 = x.slice();\n    var r1 = [];\n\n    for (var i = 0; i < 4; ++i) {\n      var bits = y[i];\n\n      for (var j = 31; j >= 0; --j) {\n        if ((bits & 1 << j) !== 0) {\n          helpers.xor(r1, r0);\n        }\n\n        if (helpers.shiftRight(r0) !== 0) {\n          r0[0] ^= helpers.E1;\n        }\n      }\n    }\n\n    helpers.arrayCopy(r1, 0, x, 0, 4);\n  },\n  multiplyP: function (x, y) {\n    switch (arguments.length) {\n      case 1:\n        if (helpers.shiftRight(x) !== 0) {\n          x[0] ^= helpers.E1;\n        }\n\n        break;\n\n      case 2:\n        if (helpers.shiftRight(x, y) !== 0) {\n          y[0] ^= helpers.E1;\n        }\n\n        break;\n\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  multiplyP8: function (x, y) {\n    var c;\n\n    switch (arguments.length) {\n      case 1:\n        c = helpers.shiftRightN(x, 8);\n        x[0] ^= helpers.LOOKUP[c >>> 24];\n        break;\n\n      case 2:\n        c = helpers.shiftRightN(x, 8, y);\n        y[0] ^= helpers.LOOKUP[c >>> 24];\n        break;\n\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  }\n};","map":{"version":3,"sources":["/home/s41m0n/Documents/University/Turin/YearII/CrownLabs/frontend/node_modules/node-jose/lib/deps/ciphermodes/gcm/helpers.js"],"names":["Long","require","fill","pack","E1","E1B","E1L","generateLookup","lookup","c","v","i","push","helpers","module","exports","LOOKUP","arrayCopy","src","srcPos","dest","destPos","length","TypeError","Uint8Array","subarray","slice","set","arrayEqual","a1","a2","len","Math","min","result","idx","asBytes","x","z","arguments","Buffer","alloc","intToBigEndian","asInts","bigEndianToInt","oneAsInts","tmp","shiftRight","b","shiftRightN","n","nInv","xor","y","multiply","r0","r1","bits","j","multiplyP","multiplyP8"],"mappings":"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","sourcesContent":["/*!\n * deps/ciphermodes/gcm/helpers.js - AES-GCM Helper Functions\n *\n * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.\n */\n\"use strict\";\n\nvar Long = require(\"long\"),\n    fill = require(\"lodash\").fill,\n    pack = require(\"../pack.js\");\n\nvar E1 = 0xe1000000,\n    E1B = 0xe1,\n    E1L = new Long(E1 >> 8);\n\nfunction generateLookup() {\n  var lookup = [];\n\n  for (var c = 0; c < 256; ++c) {\n    var v = 0;\n    for (var i = 7; i >= 0; --i) {\n      if ((c & (1 << i)) !== 0) {\n        v ^= (E1 >>> (7 - i));\n      }\n    }\n    lookup.push(v);\n  }\n\n  return lookup;\n}\n\nvar helpers = module.exports = {\n  // ### Constants\n  E1: E1,\n  E1B: E1B,\n  E1L: E1L,\n  LOOKUP: generateLookup(),\n\n  // ### Array Helpers\n  arrayCopy: function(src, srcPos, dest, destPos, length) {\n    // Start by checking for negatives since arrays in JS auto-expand\n    if (srcPos < 0 || destPos < 0 || length < 0) {\n      throw new TypeError(\"Invalid input.\");\n    }\n\n    if (dest instanceof Uint8Array) {\n      // Check for overflow if dest is a typed-array\n      if (destPos >= dest.length || (destPos + length) > dest.length) {\n        throw new TypeError(\"Invalid input.\");\n      }\n\n      if (srcPos !== 0 || length < src.length) {\n        if (src instanceof Uint8Array) {\n          src = src.subarray(srcPos, srcPos + length);\n        } else {\n          src = src.slice(srcPos, srcPos + length);\n        }\n      }\n\n      dest.set(src, destPos);\n    } else {\n      for (var i = 0; i < length; ++i) {\n        dest[destPos + i] = src[srcPos + i];\n      }\n    }\n  },\n  arrayEqual: function(a1, a2) {\n    a1 = a1 || [];\n    a2 = a2 || [];\n\n    var len = Math.min(a1.length, a2.length),\n        result = (a1.length === a2.length);\n\n    for (var idx = 0; idx < len; idx++) {\n      result = result &&\n               (\"undefined\" !== typeof a1[idx]) &&\n               (\"undefined\" !== typeof a2[idx]) &&\n               (a1[idx] === a2[idx]);\n    }\n\n    return result;\n  },\n\n  // ### Conversions\n  asBytes: function(x, z) {\n    switch (arguments.length) {\n      case 1:\n        z = Buffer.alloc(16);\n        pack.intToBigEndian(x, z, 0);\n        return z;\n      case 2:\n        pack.intToBigEndian(x, z, 0);\n        break;\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  asInts: function(x, z) {\n    switch (arguments.length) {\n      case 1:\n        z = [];\n        fill(z, 0, 0, 4);\n        pack.bigEndianToInt(x, 0, z);\n        return z;\n      case 2:\n        pack.bigEndianToInt(x, 0, z);\n        break;\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  oneAsInts: function() {\n    var tmp = [];\n    for (var c = 0; c < 4; ++c) {\n        tmp.push(1 << 31);\n    }\n    return tmp;\n  },\n\n  // ## Bit-wise\n  shiftRight: function(x, z) {\n    var b, c;\n    switch (arguments.length) {\n      case 1:\n        b = x[0];\n        x[0] = b >>> 1;\n        c = b << 31;\n        b = x[1];\n        x[1] = (b >>> 1) | c;\n        c = b << 31;\n        b = x[2];\n        x[2] = (b >>> 1) | c;\n        c = b << 31;\n        b = x[3];\n        x[3] = (b >>> 1) | c;\n        return (b << 31) & 0xffffffff;\n      case 2:\n        b = x[0];\n        z[0] = b >>> 1;\n        c = b << 31;\n        b = x[1];\n        z[1] = (b >>> 1) | c;\n        c = b << 31;\n        b = x[2];\n        z[2] = (b >>> 1) | c;\n        c = b << 31;\n        b = x[3];\n        z[3] = (b >>> 1) | c;\n        return (b << 31) & 0xffffffff;\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  shiftRightN: function(x, n, z) {\n    var nInv, b, c;\n    switch (arguments.length) {\n      case 2:\n        b = x[0];\n        nInv = 32 - n;\n        x[0] = b >>> n;\n        c = b << nInv;\n        b = x[1];\n        x[1] = (b >>> n) | c;\n        c = b << nInv;\n        b = x[2];\n        x[2] = (b >>> n) | c;\n        c = b << nInv;\n        b = x[3];\n        x[3] = (b >>> n) | c;\n        return b << nInv;\n      case 3:\n        b = x[0];\n        nInv = 32 - n;\n        z[0] = b >>> n;\n        c = b << nInv;\n        b = x[1];\n        z[1] = (b >>> n) | c;\n        c = b << nInv;\n        b = x[2];\n        z[2] = (b >>> n) | c;\n        c = b << nInv;\n        b = x[3];\n        z[3] = (b >>> n) | c;\n        return b << nInv;\n      default:\n        throw new TypeError(\"Expected 2 or 3 arguments.\");\n    }\n  },\n  xor: function(x, y, z) {\n    switch (arguments.length) {\n      case 2:\n        x[0] ^= y[0];\n        x[1] ^= y[1];\n        x[2] ^= y[2];\n        x[3] ^= y[3];\n        break;\n      case 3:\n        z[0] = x[0] ^ y[0];\n        z[1] = x[1] ^ y[1];\n        z[2] = x[2] ^ y[2];\n        z[3] = x[3] ^ y[3];\n        break;\n      default:\n        throw new TypeError(\"Expected 2 or 3 arguments.\");\n    }\n  },\n\n  multiply: function(x, y) {\n    var r0 = x.slice();\n    var r1 = [];\n\n    for (var i = 0; i < 4; ++i) {\n      var bits = y[i];\n      for (var j = 31; j >= 0; --j) {\n        if ((bits & (1 << j)) !== 0) {\n          helpers.xor(r1, r0);\n        }\n\n        if (helpers.shiftRight(r0) !== 0) {\n          r0[0] ^= helpers.E1;\n        }\n      }\n    }\n\n    helpers.arrayCopy(r1, 0, x, 0, 4);\n  },\n  multiplyP: function(x, y) {\n    switch (arguments.length) {\n      case 1:\n        if (helpers.shiftRight(x) !== 0) {\n          x[0] ^= helpers.E1;\n        }\n        break;\n      case 2:\n        if (helpers.shiftRight(x, y) !== 0) {\n          y[0] ^= helpers.E1;\n        }\n        break;\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  },\n  multiplyP8: function(x, y) {\n    var c;\n    switch (arguments.length) {\n      case 1:\n        c = helpers.shiftRightN(x, 8);\n        x[0] ^= helpers.LOOKUP[c >>> 24];\n        break;\n      case 2:\n        c = helpers.shiftRightN(x, 8, y);\n        y[0] ^= helpers.LOOKUP[c >>> 24];\n        break;\n      default:\n        throw new TypeError(\"Expected 1 or 2 arguments.\");\n    }\n  }\n};\n"]},"metadata":{},"sourceType":"script"}