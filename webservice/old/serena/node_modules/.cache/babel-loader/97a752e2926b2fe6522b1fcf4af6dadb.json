{"ast":null,"code":"/*!\n * jwe/helpers.js - JWE Internal Helper Functions\n *\n * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.\n */\n\"use strict\";\n\nvar CONSTANTS = require(\"../algorithms/constants\"),\n    JWK = require(\"../jwk\");\n\nmodule.exports = {\n  slice: function (input, start) {\n    return Array.prototype.slice.call(input, start || 0);\n  },\n  generateCEK: function (enc) {\n    var ks = JWK.createKeyStore();\n    var len = CONSTANTS.KEYLENGTH[enc];\n\n    if (len) {\n      return ks.generate(\"oct\", len);\n    }\n\n    throw new Error(\"unsupported encryption algorithm\");\n  }\n};","map":{"version":3,"sources":["/home/s41m0n/Documents/University/Turin/YearII/CrownLabs/frontend/node_modules/node-jose/lib/jwe/helpers.js"],"names":["CONSTANTS","require","JWK","module","exports","slice","input","start","Array","prototype","call","generateCEK","enc","ks","createKeyStore","len","KEYLENGTH","generate","Error"],"mappings":"AAAA;;;;;AAKA;;AAEA,IAAIA,SAAS,GAAGC,OAAO,CAAC,yBAAD,CAAvB;AAAA,IACIC,GAAG,GAAGD,OAAO,CAAC,QAAD,CADjB;;AAGAE,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,KAAK,EAAE,UAASC,KAAT,EAAgBC,KAAhB,EAAuB;AAC5B,WAAOC,KAAK,CAACC,SAAN,CAAgBJ,KAAhB,CAAsBK,IAAtB,CAA2BJ,KAA3B,EAAkCC,KAAK,IAAI,CAA3C,CAAP;AACD,GAHc;AAIfI,EAAAA,WAAW,EAAE,UAASC,GAAT,EAAc;AACzB,QAAIC,EAAE,GAAGX,GAAG,CAACY,cAAJ,EAAT;AACA,QAAIC,GAAG,GAAGf,SAAS,CAACgB,SAAV,CAAoBJ,GAApB,CAAV;;AAEA,QAAIG,GAAJ,EAAS;AACL,aAAOF,EAAE,CAACI,QAAH,CAAY,KAAZ,EAAmBF,GAAnB,CAAP;AACH;;AAED,UAAM,IAAIG,KAAJ,CAAU,kCAAV,CAAN;AACD;AAbc,CAAjB","sourcesContent":["/*!\n * jwe/helpers.js - JWE Internal Helper Functions\n *\n * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.\n */\n\"use strict\";\n\nvar CONSTANTS = require(\"../algorithms/constants\"),\n    JWK = require(\"../jwk\");\n\nmodule.exports = {\n  slice: function(input, start) {\n    return Array.prototype.slice.call(input, start || 0);\n  },\n  generateCEK: function(enc) {\n    var ks = JWK.createKeyStore();\n    var len = CONSTANTS.KEYLENGTH[enc];\n\n    if (len) {\n        return ks.generate(\"oct\", len);\n    }\n\n    throw new Error(\"unsupported encryption algorithm\");\n  }\n};\n"]},"metadata":{},"sourceType":"script"}