{"ast":null,"code":"/*!\n * deps/ciphermodes/gcm/multipliers.js - AES-GCM Multipliers\n *\n * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.\n */\n\"use strict\";\n\nvar helpers = require(\"./helpers.js\"),\n    pack = require(\"../pack.js\"); // ### 8K Table Multiplier\n\n\nfunction Gcm8KMultiplier() {\n  this.H = [];\n  this.M = null;\n}\n\nGcm8KMultiplier.prototype.init = function (H) {\n  var i, j, k;\n\n  if (this.M == null) {\n    // sc: I realize this UGLY...\n    //M = new int[32][16][4];\n    this.M = [];\n\n    for (i = 0; i < 32; ++i) {\n      this.M[i] = [];\n\n      for (j = 0; j < 16; ++j) {\n        this.M[i][j] = [];\n\n        for (k = 0; k < 4; ++k) {\n          this.M[i][j][k] = 0;\n        }\n      }\n    }\n  } else if (helpers.arrayEqual(this.H, H)) {\n    return;\n  }\n\n  this.H = H.slice(); // M[0][0] is ZEROES;\n  // M[1][0] is ZEROES;\n\n  helpers.asInts(H, this.M[1][8]);\n\n  for (j = 4; j >= 1; j >>= 1) {\n    helpers.multiplyP(this.M[1][j + j], this.M[1][j]);\n  }\n\n  helpers.multiplyP(this.M[1][1], this.M[0][8]);\n\n  for (j = 4; j >= 1; j >>= 1) {\n    helpers.multiplyP(this.M[0][j + j], this.M[0][j]);\n  }\n\n  i = 0;\n\n  for (;;) {\n    for (j = 2; j < 16; j += j) {\n      for (k = 1; k < j; ++k) {\n        helpers.xor(this.M[i][j], this.M[i][k], this.M[i][j + k]);\n      }\n    }\n\n    if (++i === 32) {\n      return;\n    }\n\n    if (i > 1) {\n      // M[i][0] is ZEROES;\n      for (j = 8; j > 0; j >>= 1) {\n        helpers.multiplyP8(this.M[i - 2][j], this.M[i][j]);\n      }\n    }\n  }\n};\n\nGcm8KMultiplier.prototype.multiplyH = function (x) {\n  var z = [];\n\n  for (var i = 15; i >= 0; --i) {\n    var m = this.M[i + i][x[i] & 0x0f];\n    z[0] ^= m[0];\n    z[1] ^= m[1];\n    z[2] ^= m[2];\n    z[3] ^= m[3];\n    m = this.M[i + i + 1][(x[i] & 0xf0) >>> 4];\n    z[0] ^= m[0];\n    z[1] ^= m[1];\n    z[2] ^= m[2];\n    z[3] ^= m[3];\n  }\n\n  pack.intToBigEndian(z, x, 0);\n};\n\nmodule.exports = {\n  \"8k\": Gcm8KMultiplier\n};","map":{"version":3,"sources":["/home/s41m0n/Documents/University/Turin/YearII/CrownLabs/frontend/node_modules/node-jose/lib/deps/ciphermodes/gcm/multipliers.js"],"names":["helpers","require","pack","Gcm8KMultiplier","H","M","prototype","init","i","j","k","arrayEqual","slice","asInts","multiplyP","xor","multiplyP8","multiplyH","x","z","m","intToBigEndian","module","exports"],"mappings":"AAAA;;;;;AAKC;;AAED,IAAIA,OAAO,GAAGC,OAAO,CAAC,cAAD,CAArB;AAAA,IACIC,IAAI,GAAGD,OAAO,CAAC,YAAD,CADlB,C,CAIA;;;AACA,SAASE,eAAT,GAA2B;AACzB,OAAKC,CAAL,GAAS,EAAT;AACA,OAAKC,CAAL,GAAS,IAAT;AACD;;AAEDF,eAAe,CAACG,SAAhB,CAA0BC,IAA1B,GAAiC,UAASH,CAAT,EAAY;AAC3C,MAAII,CAAJ,EAAOC,CAAP,EAAUC,CAAV;;AACA,MAAI,KAAKL,CAAL,IAAU,IAAd,EAAoB;AAClB;AACA;AACA,SAAKA,CAAL,GAAS,EAAT;;AACA,SAAKG,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,EAAhB,EAAoB,EAAEA,CAAtB,EAAyB;AACvB,WAAKH,CAAL,CAAOG,CAAP,IAAY,EAAZ;;AACA,WAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,EAAhB,EAAoB,EAAEA,CAAtB,EAAyB;AACvB,aAAKJ,CAAL,CAAOG,CAAP,EAAUC,CAAV,IAAe,EAAf;;AACA,aAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmB,EAAEA,CAArB,EAAwB;AACtB,eAAKL,CAAL,CAAOG,CAAP,EAAUC,CAAV,EAAaC,CAAb,IAAkB,CAAlB;AACD;AACF;AACF;AACF,GAbD,MAaO,IAAIV,OAAO,CAACW,UAAR,CAAmB,KAAKP,CAAxB,EAA2BA,CAA3B,CAAJ,EAAmC;AACxC;AACD;;AAED,OAAKA,CAAL,GAASA,CAAC,CAACQ,KAAF,EAAT,CAnB2C,CAqB3C;AACA;;AACAZ,EAAAA,OAAO,CAACa,MAAR,CAAeT,CAAf,EAAkB,KAAKC,CAAL,CAAO,CAAP,EAAU,CAAV,CAAlB;;AAEA,OAAKI,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAI,CAAjB,EAAoBA,CAAC,KAAK,CAA1B,EAA6B;AAC3BT,IAAAA,OAAO,CAACc,SAAR,CAAkB,KAAKT,CAAL,CAAO,CAAP,EAAUI,CAAC,GAAGA,CAAd,CAAlB,EAAoC,KAAKJ,CAAL,CAAO,CAAP,EAAUI,CAAV,CAApC;AACD;;AACDT,EAAAA,OAAO,CAACc,SAAR,CAAkB,KAAKT,CAAL,CAAO,CAAP,EAAU,CAAV,CAAlB,EAAgC,KAAKA,CAAL,CAAO,CAAP,EAAU,CAAV,CAAhC;;AAEA,OAAKI,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAI,CAAjB,EAAoBA,CAAC,KAAK,CAA1B,EAA6B;AAC3BT,IAAAA,OAAO,CAACc,SAAR,CAAkB,KAAKT,CAAL,CAAO,CAAP,EAAUI,CAAC,GAAGA,CAAd,CAAlB,EAAoC,KAAKJ,CAAL,CAAO,CAAP,EAAUI,CAAV,CAApC;AACD;;AAEDD,EAAAA,CAAC,GAAG,CAAJ;;AACA,WAAS;AACP,SAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,EAAhB,EAAoBA,CAAC,IAAIA,CAAzB,EAA4B;AAC1B,WAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGD,CAAhB,EAAmB,EAAEC,CAArB,EAAwB;AACtBV,QAAAA,OAAO,CAACe,GAAR,CAAY,KAAKV,CAAL,CAAOG,CAAP,EAAUC,CAAV,CAAZ,EAA0B,KAAKJ,CAAL,CAAOG,CAAP,EAAUE,CAAV,CAA1B,EAAwC,KAAKL,CAAL,CAAOG,CAAP,EAAUC,CAAC,GAAGC,CAAd,CAAxC;AACD;AACF;;AAED,QAAI,EAAEF,CAAF,KAAQ,EAAZ,EAAgB;AACd;AACD;;AAED,QAAIA,CAAC,GAAG,CAAR,EAAW;AACT;AACA,WAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,KAAK,CAAzB,EAA4B;AAC1BT,QAAAA,OAAO,CAACgB,UAAR,CAAmB,KAAKX,CAAL,CAAOG,CAAC,GAAG,CAAX,EAAcC,CAAd,CAAnB,EAAqC,KAAKJ,CAAL,CAAOG,CAAP,EAAUC,CAAV,CAArC;AACD;AACF;AACF;AACF,CArDD;;AAsDAN,eAAe,CAACG,SAAhB,CAA0BW,SAA1B,GAAsC,UAASC,CAAT,EAAY;AAChD,MAAIC,CAAC,GAAG,EAAR;;AACA,OAAK,IAAIX,CAAC,GAAG,EAAb,EAAiBA,CAAC,IAAI,CAAtB,EAAyB,EAAEA,CAA3B,EAA8B;AAC5B,QAAIY,CAAC,GAAG,KAAKf,CAAL,CAAOG,CAAC,GAAGA,CAAX,EAAcU,CAAC,CAACV,CAAD,CAAD,GAAO,IAArB,CAAR;AACAW,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACAD,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACAD,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACAD,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACAA,IAAAA,CAAC,GAAG,KAAKf,CAAL,CAAOG,CAAC,GAAGA,CAAJ,GAAQ,CAAf,EAAkB,CAACU,CAAC,CAACV,CAAD,CAAD,GAAO,IAAR,MAAkB,CAApC,CAAJ;AACAW,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACAD,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACAD,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACAD,IAAAA,CAAC,CAAC,CAAD,CAAD,IAAQC,CAAC,CAAC,CAAD,CAAT;AACD;;AAEDlB,EAAAA,IAAI,CAACmB,cAAL,CAAoBF,CAApB,EAAuBD,CAAvB,EAA0B,CAA1B;AACD,CAhBD;;AAmBAI,MAAM,CAACC,OAAP,GAAiB;AACf,QAAMpB;AADS,CAAjB","sourcesContent":["/*!\n * deps/ciphermodes/gcm/multipliers.js - AES-GCM Multipliers\n *\n * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.\n */\n \"use strict\";\n\nvar helpers = require(\"./helpers.js\"),\n    pack = require(\"../pack.js\");\n\n\n// ### 8K Table Multiplier\nfunction Gcm8KMultiplier() {\n  this.H = [];\n  this.M = null;\n}\n\nGcm8KMultiplier.prototype.init = function(H) {\n  var i, j, k;\n  if (this.M == null) {\n    // sc: I realize this UGLY...\n    //M = new int[32][16][4];\n    this.M = [];\n    for (i = 0; i < 32; ++i) {\n      this.M[i] = [];\n      for (j = 0; j < 16; ++j) {\n        this.M[i][j] = [];\n        for (k = 0; k < 4; ++k) {\n          this.M[i][j][k] = 0;\n        }\n      }\n    }\n  } else if (helpers.arrayEqual(this.H, H)) {\n    return;\n  }\n\n  this.H = H.slice();\n\n  // M[0][0] is ZEROES;\n  // M[1][0] is ZEROES;\n  helpers.asInts(H, this.M[1][8]);\n\n  for (j = 4; j >= 1; j >>= 1) {\n    helpers.multiplyP(this.M[1][j + j], this.M[1][j]);\n  }\n  helpers.multiplyP(this.M[1][1], this.M[0][8]);\n\n  for (j = 4; j >= 1; j >>= 1) {\n    helpers.multiplyP(this.M[0][j + j], this.M[0][j]);\n  }\n\n  i = 0;\n  for (;;) {\n    for (j = 2; j < 16; j += j) {\n      for (k = 1; k < j; ++k) {\n        helpers.xor(this.M[i][j], this.M[i][k], this.M[i][j + k]);\n      }\n    }\n\n    if (++i === 32) {\n      return;\n    }\n\n    if (i > 1) {\n      // M[i][0] is ZEROES;\n      for (j = 8; j > 0; j >>= 1) {\n        helpers.multiplyP8(this.M[i - 2][j], this.M[i][j]);\n      }\n    }\n  }\n};\nGcm8KMultiplier.prototype.multiplyH = function(x) {\n  var z = [];\n  for (var i = 15; i >= 0; --i) {\n    var m = this.M[i + i][x[i] & 0x0f];\n    z[0] ^= m[0];\n    z[1] ^= m[1];\n    z[2] ^= m[2];\n    z[3] ^= m[3];\n    m = this.M[i + i + 1][(x[i] & 0xf0) >>> 4];\n    z[0] ^= m[0];\n    z[1] ^= m[1];\n    z[2] ^= m[2];\n    z[3] ^= m[3];\n  }\n\n  pack.intToBigEndian(z, x, 0);\n};\n\n\nmodule.exports = {\n  \"8k\": Gcm8KMultiplier\n};\n"]},"metadata":{},"sourceType":"script"}